<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="js/jquery-1.9.0.min.js" type="text/javascript"></script>
    <script src="js/jquery.mobile-1.3.0-rc.1.js" type="text/javascript"></script>
    <link rel="stylesheet" href="css/custom.css">
    <link rel="stylesheet" href="css/jqm-demos.css">
    <link rel="stylesheet" href="css/jquery.mobile-1.3.0-rc.1.css">
    <script src="js/jquery.mobile.pagination.js" type="text/javascript"></script>
    <link rel="stylesheet" href="css/jquery.mobile.pagination.css">
</head>
<body>
	<div data-role="page" id="home">
		<div data-role="header" data-theme="f">
			<h1>My Favourite Things</h1>
		</div><!-- /header -->

		<div data-role="content">
			<div data-demo-html="true">
				<ul data-role="listview" data-inset="true">
					<li data-role="list-divider" hidden="true"> Welcome! </li>
					<li> This application will organize list of favourites in twitter. Swipe right on the bottom strip to start the application</li>
				</ul>
			</div>
		</div>

		<div class="jqm-footer">
			<ul data-role="listview" data-inset="true">
				<li id="StartApp" class="changePage">
					<input id="homepage" class="changePage" type="hidden" value='{"right":"#page1"}'></input>
					Let's start the application >>>>
				</li>
			</ul>
		</div>
	</div>

</body>



<script type="text/javascript">
    $.getJSON('june.json', function (data) {
		var numPage = 1;
		var lastPage = 1;
		var count = 0;
		makePage(numPage, lastPage);
		$('#swipePage'+numPage).attr("value", '{"left":"end", "right":"#page2"}');
        $.each(data, function (index) {
			if (count > 9)
			{ // if tweet count exceeds 10 per page, reset the count and increment pageNum
				count = 0;
				numPage = numPage + 1;
			}

			if (count == 0 && numPage != 1)
			{ // if count = 0, we need to make new page
				$('#tweet'+(numPage-1)).listview("refresh");
				makePage(numPage, lastPage);
				$('#swipePage'+numPage).attr("value", '{"left":"#page"'+(numPage - 1)+', "right":"#page"'+(numpage + 1)+'}');
				lastPage = numPage;
			}
			var tweet = this;
			var shtml='';
			shtml=shtml+'<li>';
			shtml=shtml+'<img src=\"'+tweet.user.profile_image_url+'\" />';
			shtml=shtml+'<h3>'+tweet.text+'</h3>';
			shtml=shtml+'<p> Count:'+tweet.favorite_count+'</p>';
			shtml=shtml+'</li>';
			$('#tweet'+numPage).append(shtml);
			count = count + 1;
        });

    });
	function makePage(numPage, lastPage) {
		//page
		var newPage = document.createElement('div');
		newPage.setAttribute('data-role', 'page');
		newPage.setAttribute('id', 'page'+numPage);
		//page content
		var content = document.createElement('div');
		content.setAtribute('data-role', 'content');
		//demo-html
		var demoHtml = document.createElement('div');
		demoHtml.setAttribute('data-demo-html', 'true');
		//listview
		//data goes in here
		var tweet = document.createElement('ul');
		tweet.setAttribute('id', 'tweet'+numPage);
		tweet.setAttribute('data-role', 'listview');
		tweet.setAttribute('data-inset', 'true');
		// footer/swipe
		var footer = document.createElement('div');
		footer.setAttribute('class', 'jqm-footer');
		var footerList = document.createElement('ul');
		footerList.setAttribute('data-role', 'listview');
		footerList.setAttribute('data-inset', 'true');
		var swipe = document.createElement('li');
		swipe.setAttribute('id', 'swipe'+numPage);
		swipe.setAttribute('class', 'changePage');
		var swipeValue = document.createElement('input');
		swipeValue.setAttribute('id', 'swipePage'+numPage);
		swipeValue.setAttribute('type', 'hidden');
		var swipeText = document.createTextNode("<<<< swipe to navigate page >>>>");

		swipe.appendChild(swipeText);
		swipe.appendChild(swipeValue);
		footerList.appendChild(swipe);
		footer.appendChild(footerList);

		demoHtml.appendChild(tweet);
		content.appendChild(demoHtml);

		newPage.appendChild(content);
		newPage.appendChild(footer);
		$('body').append(newPage);
	}
</script>

<script type="text/javascript">
	$(document).on('pagebeforecreate', fuction() {
		$(".changePage").swiperight(function(event) {
				var target = $(this).find("input").attr("value").right;
				alert(target);
				if (target == "end") {
					alert("You are in the last page of the application!");
					event.stopImmediatePropagation();
				}
				$.mobile.changePage(target);
				event.stopImmediatePropagation();
		});

		$(".changePage").swipeleft(function(event) {
				var target = $(this).find("input").attr("value").left;
				alert(target);
				if (target == "end") {
					alert("You are in the first page of the application!");
					event.stopImmediatePropagation();
				}
				$.mobile.changePage(target);
				event.stopImmediatePropagation();
		});


	});
</script>
</html>
